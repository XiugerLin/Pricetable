<!DOCTYPE html>

<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>æ•¸ä½è²¼ç´™åƒ¹ç›®è¡¨</title>
  <style>
    /* åŸºç¤æ¨£å¼ */
    * { box-sizing: border-box !important; }

```
body { 
  font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif !important; 
  margin: 0 !important; 
  padding: 16px !important; 
  background: #f8f9fa !important;
  font-size: 16px !important;
  line-height: 1.5 !important;
}

/* å…±ç”¨æ¨£å¼ */
.header {
  text-align: center !important;
  margin-bottom: 20px !important;
  color: #333 !important;
}

.header h1 {
  margin: 0 0 8px 0 !important;
  font-size: 24px !important;
  font-weight: bold !important;
}

.header p {
  margin: 0 !important;
  color: #666 !important;
  font-size: 14px !important;
}

.section {
  margin-bottom: 20px !important;
  padding: 16px !important;
  border-radius: 12px !important;
  border: 1px solid #ddd !important;
  background: white !important;
  box-shadow: 0 2px 4px rgba(0,0,0,0.1) !important;
  position: relative !important;
  z-index: 10 !important;
}

.size-buttons { background-color: #f5f5f5 !important; }
.select-area { background-color: #fafafa !important; border-color: #e0e0e0 !important; }

/* æ”¶åˆåŠŸèƒ½æ¨£å¼ */
.collapsible-header {
  display: flex !important;
  justify-content: space-between !important;
  align-items: center !important;
  cursor: pointer !important;
  user-select: none !important;
  -webkit-tap-highlight-color: transparent !important;
}

.collapse-btn {
  background: none !important;
  border: none !important;
  font-size: 18px !important;
  color: #666 !important;
  cursor: pointer !important;
  padding: 4px !important;
  border-radius: 4px !important;
  transition: all 0.2s ease !important;
  display: none !important;
}

.collapse-btn:hover { background: rgba(0,0,0,0.1) !important; }

.collapsible-content {
  overflow: visible !important;
  transition: max-height 0.3s ease, opacity 0.3s ease !important;
  position: relative !important;
  z-index: 10 !important;
}

.collapsible-content.collapsed {
  max-height: 0 !important;
  opacity: 0 !important;
  margin-top: 0 !important;
  overflow: hidden !important;
  pointer-events: none !important;
  z-index: 5 !important;
}

/* æŒ‰éˆ•ç¶²æ ¼ */
.button-grid {
  display: grid !important;
  grid-template-columns: repeat(auto-fit, minmax(80px, 1fr)) !important;
  gap: 10px !important;
}

.size-btn {
  padding: 12px 8px !important;
  border: 2px solid #ccc !important;
  background: #fff !important;
  border-radius: 8px !important;
  cursor: pointer !important;
  font-size: 13px !important;
  font-weight: 500 !important;
  transition: all 0.2s ease !important;
  text-align: center !important;
  min-height: 44px !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  -webkit-tap-highlight-color: transparent !important;
}

.size-btn:hover { 
  background: #e0e0e0 !important; 
  border-color: #999 !important; 
  transform: translateY(-1px) !important;
}

.size-btn:active { transform: translateY(0) !important; }

.size-btn.active { 
  background: #ffcc00 !important; 
  border-color: #ffaa00 !important; 
  font-weight: bold !important;
  box-shadow: 0 2px 8px rgba(255, 204, 0, 0.3) !important;
}

/* é¸å–®å®¹å™¨ */
.select-container {
  display: flex !important;
  gap: 16px !important;
  align-items: flex-end !important;
  flex-wrap: wrap !important;
}

.select-group {
  flex: 1 !important;
  min-width: 150px !important;
}

.select-group label {
  display: block !important;
  margin-bottom: 6px !important;
  font-size: 16px !important;
  font-weight: 600 !important;
  color: #333 !important;
}

/* è¼¸å…¥æ¡†æ¨£å¼ */
#size-select, #material-input { 
  padding: 12px 16px !important; 
  font-size: 16px !important; 
  border: 2px solid #ccc !important; 
  border-radius: 8px !important; 
  width: 100% !important;
  background: white !important;
  outline: none !important;
  transition: border-color 0.2s ease, box-shadow 0.2s ease !important;
}

#size-select {
  appearance: none !important;
  background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24' fill='none' stroke='currentColor' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3e%3cpolyline points='6,9 12,15 18,9'%3e%3c/polyline%3e%3c/svg%3e") !important;
  background-repeat: no-repeat !important;
  background-position: right 12px center !important;
  background-size: 16px !important;
  padding-right: 40px !important;
  cursor: pointer !important;
  position: relative !important;
  z-index: 100 !important;
}

#size-select:focus, #material-input:focus {
  border-color: #ff9800 !important;
  box-shadow: 0 0 0 2px rgba(255, 152, 0, 0.2) !important;
}

#material-input { padding-right: 40px !important; }

/* æè³ªä¸‹æ‹‰é¸å–® */
.material-search-container {
  position: relative !important;
  width: 100% !important;
  z-index: 100 !important;
}

.material-dropdown-btn {
  position: absolute !important;
  right: 8px !important;
  top: 50% !important;
  transform: translateY(-50%) !important;
  width: 24px !important;
  height: 24px !important;
  border: none !important;
  background: none !important;
  cursor: pointer !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  color: #666 !important;
  font-size: 14px !important;
  transition: transform 0.2s ease !important;
}

.material-dropdown-btn.open { transform: translateY(-50%) rotate(180deg) !important; }

.material-dropdown {
  position: absolute !important;
  top: 100% !important;
  left: 0 !important;
  right: 0 !important;
  background: white !important;
  border: 2px solid #ccc !important;
  border-top: none !important;
  border-radius: 0 0 8px 8px !important;
  max-height: 200px !important;
  overflow-y: auto !important;
  z-index: 1002 !important;
  display: none !important;
  box-shadow: 0 4px 6px rgba(0,0,0,0.1) !important;
}

.material-dropdown.show { display: block !important; }

.material-option {
  padding: 10px 16px !important;
  cursor: pointer !important;
  border-bottom: 1px solid #eee !important;
  transition: background-color 0.2s ease !important;
}

.material-option:hover, .material-option.highlighted { background-color: #f0f8ff !important; }
.material-option:last-child { border-bottom: none !important; }

.no-results {
  padding: 10px 16px !important;
  color: #999 !important;
  font-style: italic !important;
}

/* è¡¨æ ¼æ¨£å¼ */
.table-header {
  padding: 12px 16px !important;
  font-size: 24px !important;
  color: #ff8c00 !important;
  text-align: center !important;
  font-weight: bold !important;
  margin: 0 !important;
}

.table-wrapper {
  border-radius: 8px !important;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1) !important;
  background: white !important;
  position: relative !important;
  overflow: visible !important;
  margin-top: 12px !important;
  border: 1px solid #e0e0e0 !important;
}

/* ç•¶è¡¨æ ¼åœ¨è¦–çª—é ‚éƒ¨é™„è¿‘æ™‚çš„ç‰¹æ®Šæ¨£å¼ */
.table-wrapper.near-top .table-scroll-container {
  height: calc(100vh - 100px) !important;
  max-height: 90vh !important;
}

/* æ¢å¾©æ‹–å‹•å€åŸŸ */
.drag-area {
  height: 40px !important;
  background: #f0f0f0 !important;
  display: flex !important;
  align-items: center !important;
  justify-content: center !important;
  color: #999 !important;
  font-size: 12px !important;
  cursor: grab !important;
  user-select: none !important;
  -webkit-user-select: none !important;
  touch-action: pan-y !important;
  border-radius: 8px 8px 0 0 !important;
  position: relative !important;
}

.drag-area:active { cursor: grabbing !important; }
.drag-area::before { content: "â‹¯" !important; font-size: 16px !important; color: #ccc !important; }

/* ä¿®æ”¹è¡¨æ ¼æ»¾å‹•å®¹å™¨ - å‹•æ…‹é«˜åº¦èˆ‡å‚ç›´æ»¾å‹• */
.table-scroll-container {
  overflow-x: auto !important;
  overflow-y: auto !important;
  -webkit-overflow-scrolling: touch !important;
  height: 60vh !important; /* é è¨­é«˜åº¦ï¼Œæœƒç”± JS å‹•æ…‹èª¿æ•´ */
  min-height: 300px !important;
  max-height: 85vh !important;
  will-change: height !important; /* å„ªåŒ–é«˜åº¦è®ŠåŒ–çš„æ€§èƒ½ */
}

table { 
  border-collapse: separate !important;
  border-spacing: 0 !important;
  width: 100% !important; 
  min-width: 580px !important;
  font-size: 14px !important;
  position: relative !important;
  margin: 0 !important;
  padding: 0 !important;
}

td, th { 
  padding: 10px 6px !important; 
  text-align: center !important; 
  border: 1px solid #e0e0e0 !important;
  white-space: nowrap !important;
  background: white !important;
  margin: 0 !important;
}

.material-name {
  position: sticky !important;
  left: 0 !important;
  z-index: 2 !important;
  font-weight: 600 !important;
  text-align: left !important;
  padding: 10px 8px 10px 10px !important;
  max-width: 130px !important;
  min-width: 120px !important;
  word-wrap: break-word !important;
  box-shadow: 2px 0 5px rgba(0,0,0,0.1) !important;
  border-left: none !important;
  font-size: 15px !important;
  line-height: 1.3 !important;
}

.qty-header, .empty-corner {
  position: sticky !important;
  top: 0 !important;
  z-index: 2 !important;
  font-weight: bold !important;
  color: #333 !important;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1) !important;
  border-top: none !important;
}

.empty-corner {
  position: sticky !important;
  left: 0 !important;
  top: 0 !important;
  z-index: 3 !important;
  background: #f8f9fa !important;
  border-left: none !important;
  border-top: none !important;
}

.qty-header { background: #ffcc00 !important; }
.material-even { background: #ffcc66 !important; }
.material-odd { background: #ffcc00 !important; }
.price-even { background: #f8f9fa !important; }
.price-odd { background: #fff !important; }

/* é«˜äº®å‹•ç•« */
.material-highlight {
  animation: highlightFlash 1s ease-in-out 1 !important;
}

.material-highlight td {
  animation: highlightFlash 1s ease-in-out 1 !important;
  background-color: #fff3e0 !important;
  border-left: 3px solid #ff9800 !important;
}

@keyframes highlightFlash {
  0%, 100% { background-color: #fff3e0 !important; }
  50% { background-color: #ffcc80 !important; }
}

.scroll-hint {
  text-align: center !important;
  color: #666 !important;
  font-size: 12px !important;
  margin-top: 8px !important;
  display: block !important;
}

.loading {
  text-align: center !important;
  color: #666 !important;
}

.table-loading { opacity: 0.5 !important; pointer-events: none !important; }

.sr-only {
  position: absolute !important;
  width: 1px !important;
  height: 1px !important;
  padding: 0 !important;
  margin: -1px !important;
  overflow: hidden !important;
  clip: rect(0, 0, 0, 0) !important;
  white-space: nowrap !important;
  border: 0 !important;
}

/* å›åˆ°é ‚éƒ¨æŒ‰éˆ• */
.back-to-top {
  position: fixed !important;
  bottom: 20px !important;
  right: 20px !important;
  width: 50px !important;
  height: 50px !important;
  background: #ff8c00 !important;
  color: white !important;
  border: none !important;
  border-radius: 50% !important;
  cursor: pointer !important;
  display: none !important;
  align-items: center !important;
  justify-content: center !important;
  font-size: 20px !important;
  box-shadow: 0 4px 12px rgba(0,0,0,0.2) !important;
  transition: all 0.3s ease !important;
  z-index: 1000 !important;
  -webkit-tap-highlight-color: transparent !important;
}

.back-to-top:hover {
  background: #ff7700 !important;
  transform: translateY(-2px) !important;
  box-shadow: 0 6px 16px rgba(0,0,0,0.3) !important;
}

.back-to-top:active { transform: translateY(0) !important; }
.back-to-top.show { display: flex !important; animation: fadeInUp 0.3s ease !important; }

@keyframes fadeInUp {
  from { opacity: 0 !important; transform: translateY(20px) !important; }
  to { opacity: 1 !important; transform: translateY(0) !important; }
}

/* éŸ¿æ‡‰å¼è¨­è¨ˆ */
@media (max-width: 768px) {
  body { padding: 8px !important; font-size: 14px !important; }
  .header { margin-bottom: 12px !important; }
  .header h1 { font-size: 18px !important; margin-bottom: 4px !important; }
  .header p { font-size: 12px !important; }
  .section { padding: 10px !important; margin-bottom: 12px !important; }
  .collapse-btn { display: block !important; }
  .size-buttons .collapsible-content, .select-area .collapsible-content { margin-top: 12px !important; }
  .button-grid { grid-template-columns: repeat(auto-fit, minmax(65px, 1fr)) !important; gap: 6px !important; }
  .select-container { gap: 10px !important; flex-direction: column !important; }
  .select-group { min-width: 100% !important; }
  table { font-size: 12px !important; min-width: 520px !important; }
  td, th { padding: 8px 4px !important; }
  .material-name { min-width: 110px !important; max-width: 110px !important; font-size: 13px !important; }
  .table-header { font-size: 18px !important; padding: 6px 8px !important; }
  .table-wrapper { margin-top: 6px !important; }
  .table-scroll-container { 
    height: 70vh !important; 
    min-height: 300px !important;
    max-height: 85vh !important;
  }
  .drag-area { height: 35px !important; }
  .scroll-hint { display: block !important; font-size: 11px !important; margin-top: 6px !important; }
  .back-to-top { width: 45px !important; height: 45px !important; bottom: 15px !important; right: 15px !important; font-size: 18px !important; }
}

@media (max-width: 480px) {
  body { padding: 6px !important; }
  .header { margin-bottom: 10px !important; }
  .section { padding: 8px !important; margin-bottom: 8px !important; }
  .button-grid { grid-template-columns: repeat(4, 1fr) !important; gap: 4px !important; }
  .table-scroll-container { 
    height: 75vh !important; 
    min-height: 250px !important;
    max-height: 90vh !important;
  }
  .drag-area { height: 30px !important; }
  .scroll-hint { margin-top: 4px !important; }
  .back-to-top { width: 40px !important; height: 40px !important; bottom: 10px !important; right: 10px !important; font-size: 16px !important; }
}

/* å¹³æ¿è£ç½®å„ªåŒ– */
@media (min-width: 769px) and (max-width: 1024px) {
  .table-scroll-container { 
    height: 65vh !important; 
    min-height: 400px !important;
    max-height: 80vh !important;
  }
  .section { margin-bottom: 16px !important; }
  table { font-size: 13px !important; }
}

@media (prefers-reduced-motion: reduce) {
  * { animation: none !important; transition: none !important; scroll-behavior: auto !important; }
}

@media (pointer: coarse) {
  .size-btn { min-height: 48px !important; padding: 14px 8px !important; }
  #size-select, #material-input { min-height: 48px !important; padding: 14px 16px !important; }
  .material-option { padding: 14px 16px !important; min-height: 48px !important; }
  .drag-area { height: 50px !important; }
}
```

  </style>
</head>
<body>
  <div class="header">
    <h1>ğŸ·ï¸ æ•¸ä½è²¼ç´™åƒ¹ç›®è¡¨</h1>
    <p>é¸æ“‡å°ºå¯¸æŸ¥çœ‹å„æè³ªåƒ¹æ ¼</p>
  </div>

  <div class="section size-buttons">
    <div class="collapsible-header" onclick="toggleCollapse('size-buttons-content')">
      <h3>âš¡ å¿«é€Ÿé¸æ“‡å°ºå¯¸</h3>
      <button class="collapse-btn" id="size-collapse-btn" aria-expanded="true" aria-controls="size-buttons-content" aria-label="æ”¶åˆå°ºå¯¸é¸æ“‡å€åŸŸ">âˆ’</button>
    </div>
    <div class="collapsible-content" id="size-buttons-content">
      <div class="button-grid" id="buttons"></div>
    </div>
  </div>

  <div class="section select-area">
    <div class="collapsible-header" onclick="toggleCollapse('select-area-content')">
      <h3>ğŸ“‹ å°ºå¯¸æè³ªé¸å–®</h3>
      <button class="collapse-btn" id="select-collapse-btn" aria-expanded="true" aria-controls="select-area-content" aria-label="æ”¶åˆå°ºå¯¸æè³ªé¸å–®">âˆ’</button>
    </div>
    <div class="collapsible-content" id="select-area-content">
      <div class="select-container">
        <div class="select-group">
          <label for="size-select">å°ºå¯¸</label>
          <select id="size-select"></select>
        </div>
        <div class="select-group">
          <label for="material-input">æè³ª</label>
          <div class="material-search-container">
            <input type="text" id="material-input" placeholder="è¼¸å…¥æè³ªåç¨±æˆ–é»æ“Šä¸‹æ‹‰é¸æ“‡" autocomplete="off" spellcheck="false" aria-describedby="material-help">
            <button type="button" class="material-dropdown-btn" id="material-dropdown-btn" aria-label="å±•é–‹æè³ªé¸å–®" aria-expanded="false">â–¼</button>
            <div class="material-dropdown" id="material-dropdown" role="listbox" aria-label="æè³ªé¸é …"></div>
          </div>
          <div id="material-help" class="sr-only">ä½¿ç”¨æ–¹å‘éµå°èˆªï¼ŒEnteré¸æ“‡ï¼ŒEscapeé—œé–‰</div>
        </div>
      </div>
    </div>
  </div>

  <div class="table-header" id="table-header">1x1cm</div>
  <div class="table-wrapper">
    <div class="drag-area" title="æ‹–å‹•æ­¤å€åŸŸå¯æ»¾å‹•æ•´å€‹é é¢"></div>
    <div class="table-scroll-container">
      <div id="table-container" class="loading">æ­£åœ¨è¼‰å…¥åƒ¹ç›®è¡¨...</div>
    </div>
  </div>
  <div class="scroll-hint">ğŸ‘ˆğŸ‘† å¯ä¸Šä¸‹å·¦å³æ»‘å‹•ï¼Œæ¨™é¡Œåˆ—æœƒä¿æŒå›ºå®š</div>

<button class="back-to-top" id="back-to-top" aria-label="å›åˆ°é ‚éƒ¨" title="å›åˆ°é ‚éƒ¨">â†‘</button>

  <script>
    // åƒ¹ç›®è¡¨ç³»çµ±
    const PriceTableSystem = (() => {
      // é…ç½®æ•¸æ“š
      const CONFIG = {
        quantities: ["500å¼µ", "1000å¼µ", "2000å¼µ", "5000å¼µ", "10000å¼µ"],
        materials: [
          "éŠ…ç‰ˆè¶…é»è²¼(ç„¡ä¸Šå…‰)", "éŠ…ç‰ˆè¶…é»è²¼+éœ§/äº®", "æ¨¡é€ è²¼", "éŠ…ç‰ˆæ¥µé»è²¼(ç„¡ä¸Šå…‰)", "éŠ…ç‰ˆæ¥µé»è²¼+éœ§/äº®",
          "åˆæˆè²¼(ç„¡ä¸Šå…‰)", "åˆæˆè²¼+éœ§/äº®", "èµ¤ç‰›çš®è²¼", "åˆæˆå†·å‡è† (ç„¡ä¸Šå…‰)", "åˆæˆå†·å‡è† +äº®/éœ§",
          "éŠ…ç‰ˆRè† (ç„¡ä¸Šå…‰)", "éŠ…ç‰ˆRè† +äº®/éœ§", "é€æ˜è²¼(ç„¡ä¸Šå…‰)", "åˆæˆRè† (ç„¡ä¸Šå…‰)", "é€æ˜è²¼+äº®/éœ§",
          "äº®éŠ€é¾+ç™½å¢¨+äº®è†œ", "åˆæˆRè† +äº®/éœ§", "é€æ˜è²¼+ç™½å¢¨+äº®/éœ§", "éŠ€ç®”è²¼+ç™½å¢¨+äº®", "å(æ¶ˆ)éŠ€é¾è²¼+äº®",
          "åˆæˆæ¥µé»è²¼(ç„¡ä¸Šå…‰)", "åˆæˆæ¥µé»è²¼+äº®/éœ§", "å(æ¶ˆ)é‡‘é¾è²¼+äº®", "é‘½çŸ³é›·å°„è²¼+ç™½å¢¨+äº®è†œ", "ç´ é¢é›·å°„è²¼+ç™½å¢¨+äº®è†œ",
          "åšäº®éŠ€é¾+ç™½å¢¨+äº®è†œ", "ç ‚é»é›·å°„è²¼+ç™½å¢¨+äº®è†œ"
        ],
        sizes: (() => {
          const sizes = [];
          for (let i = 1; i <= 20; i++) {
            sizes.push(`1x${i}cm`);
            if (i < 20) sizes.push(`1x${i}.5cm`);
          }
          return sizes;
        })()
      };

      // åƒ¹æ ¼æ•¸æ“šï¼ˆä¿æŒåŸæœ‰æ•¸æ“šï¼‰
      const priceData = {
        "1x1cm": [[300,320,360,420,500],[300,320,360,420,500],[300,320,360,420,500],[300,320,360,420,500],[300,320,360,420,500],[300,320,360,420,500],[300,320,360,420,500],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,518],[318,348,398,468,568],[318,348,398,468,568],[318,348,398,468,568],[318,348,398,468,568],[318,348,398,468,568],[318,358,418,498,587],[332,372,432,512,600],[332,372,432,512,600],[332,372,432,512,600],[332,372,432,512,600]],
        "1x1.5cm": [[300,320,360,420,500],[300,320,360,420,500],[300,320,360,420,500],[300,320,360,420,500],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,540],[318,338,378,438,518],[318,338,378,438,576],[318,338,378,438,576],[318,338,378,438,576],[318,338,378,438,576],[318,338,378,438,576],[318,338,378,438,576],[318,348,398,468,606],[318,348,398,468,606],[318,348,398,468,637],[318,348,398,468,637],[318,348,398,468,697],[332,372,432,512,728],[332,372,432,512,772],[332,372,432,512,772],[332,372,432,512,772],[332,372,432,512,772]],
        "1x2cm": [[300,320,360,420,500],[300,320,360,420,500],[300,320,360,420,500],[300,320,360,420,500],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,540],[318,338,378,438,540],[318,338,378,438,576],[318,338,378,438,576],[318,338,378,438,576],[318,338,378,438,576],[318,338,378,438,576],[318,338,378,438,576],[318,348,398,468,606],[318,348,398,468,606],[318,348,398,468,637],[318,348,398,468,637],[318,348,398,468,697],[332,372,432,512,728],[332,372,432,512,772],[332,372,432,512,772],[332,372,432,512,772],[332,372,432,512,772]],
        "1x2.5cm": [[300,320,360,420,500],[300,320,360,420,500],[300,320,360,420,500],[300,320,360,420,500],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,518],[318,338,378,438,572],[318,338,378,438,572],[318,338,378,438,576],[318,338,378,438,606],[318,338,378,438,637],[318,338,378,438,637],[318,338,378,438,637],[318,338,378,438,697],[318,338,378,438,697],[318,338,378,438,697],[318,348,398,468,697],[318,348,398,468,697],[332,362,412,482,756],[332,362,412,482,756],[332,362,412,482,745],[332,372,432,512,799],[332,372,432,572,857],[332,372,432,572,857],[332,372,432,572,857],[332,372,432,572,857]],
        "1x3cm": [[300,320,360,420,500],[300,320,360,420,500],[300,320,360,420,500],[300,320,360,420,500],[318,338,378,438,540],[318,338,378,438,540],[318,338,378,438,576],[318,338,378,438,637],[318,338,378,438,637],[318,338,378,438,667],[318,338,378,438,667],[318,338,378,446,728],[318,346,386,446,728],[318,346,386,446,728],[318,346,386,446,745],[318,346,386,446,745],[318,346,386,446,745],[332,362,412,482,772],[332,362,412,482,772],[332,362,412,506,799],[332,362,412,506,799],[332,362,412,540,853],[332,372,432,572,857],[332,372,432,606,978],[332,372,432,606,978],[332,372,432,606,978],[332,372,432,606,978]],
        "1x3.5cm": [[300,320,360,420,500],[318,338,378,438,540],[318,338,378,438,540],[318,338,378,438,540],[318,338,378,438,576],[318,338,378,438,576],[318,338,378,438,637],[318,338,378,438,697],[318,338,378,438,697],[318,338,378,438,728],[318,346,386,446,747],[332,352,392,472,772],[332,352,392,472,772],[332,352,392,472,772],[332,352,392,506,826],[332,352,392,506,826],[332,352,392,506,826],[332,362,412,540,853],[332,362,412,540,853],[332,362,412,572,857],[332,362,412,572,857],[332,362,412,576,906],[332,372,432,606,954],[346,386,446,667,1073],[346,386,446,667,1073],[346,386,446,667,1073],[346,386,446,667,1073]],
        "1x4cm": [[318,338,378,438,540],[318,338,378,438,576],[318,338,378,438,576],[318,338,378,438,576],[318,338,378,438,637],[318,338,378,438,637],[318,338,378,438,697],[318,338,378,438,756],[318,338,378,438,756],[318,346,386,472,772],[318,346,386,446,747],[332,352,392,472,799],[332,352,392,472,799],[332,352,392,472,799],[332,352,392,572,857],[332,352,392,572,857],[332,352,392,572,857],[332,362,412,572,881],[332,362,412,572,881],[332,362,412,576,930],[332,362,412,576,930],[332,362,412,606,978],[346,386,446,667,1049],[346,386,446,756,1185],[346,386,446,756,1185],[346,386,446,756,1185],[346,386,446,756,1185]],
        "1x4.5cm": [[318,338,378,438,572],[318,338,378,438,637],[318,338,378,438,637],[318,338,378,438,637],[318,338,378,438,697],[318,338,378,438,697],[318,338,378,438,756],[318,346,386,472,799],[318,346,386,472,799],[318,346,386,472,799],[318,346,386,446,747],[332,352,392,540,853],[332,352,392,540,853],[332,352,392,576,881],[332,352,402,576,930],[332,352,402,576,930],[332,352,402,576,930],[332,362,412,606,954],[332,362,412,606,954],[332,362,416,637,1001],[332,362,416,637,1001],[332,362,416,667,1073],[346,386,446,728,1141],[346,386,446,772,1273],[346,386,446,772,1273],[346,386,446,772,1273],[346,386,446,772,1273]],
        "1x5cm": [[318,338,378,438,637],[318,338,378,438,728],[318,338,378,438,728],[318,338,378,438,728],[318,338,378,472,772],[318,338,378,472,772],[318,346,386,506,826],[332,352,392,572,881],[332,352,392,572,881],[332,352,392,576,930],[332,360,402,576,930],[332,360,416,637,1025],[332,360,416,637,1025],[332,360,416,637,1025],[332,360,416,667,1073],[332,360,416,667,1073],[332,360,416,667,1073],[332,362,416,697,1119],[332,362,416,697,1119],[346,376,430,728,1163],[346,376,430,728,1163],[346,376,430,745,1251],[346,386,446,799,1294],[360,400,472,857,1486],[360,400,472,857,1486],[360,400,472,857,1486],[360,400,472,857,1486]],
        "1x5.5cm": [[318,338,378,438,637],[318,338,378,438,728],[318,338,378,438,728],[318,338,378,438,728],[318,338,378,472,772],[318,338,378,472,772],[318,346,386,506,826],[332,352,392,572,881],[332,352,392,572,881],[332,352,392,576,930],[332,360,402,576,930],[332,360,416,637,1025],[332,360,416,637,1025],[332,360,416,637,1025],[332,360,416,667,1073],[332,360,416,667,1073],[332,360,416,667,1073],[332,362,416,697,1119],[332,362,416,697,1119],[346,376,430,728,1163],[346,376,430,728,1163],[346,376,430,745,1251],[346,386,446,799,1294],[360,400,472,857,1486],[360,400,472,857,1486],[360,400,472,857,1486],[360,400,472,857,1486]],
        "1x6cm": [[318,338,378,438,728],[318,338,378,472,799],[318,338,378,472,799],[318,338,378,472,799],[318,346,388,540,880],[318,346,388,540,880],[332,352,392,572,906],[332,360,402,606,978],[332,360,402,606,978],[332,360,416,637,1049],[332,374,430,728,1163],[332,374,430,728,1163],[332,374,430,728,1163],[346,374,430,756,1207],[346,374,430,756,1207],[346,374,430,756,1207],[346,374,430,756,1207],[346,376,434,745,1251],[346,376,434,745,1251],[346,376,434,799,1316],[346,376,434,799,1316],[346,388,438,853,1411],[346,388,472,880,1486],[360,402,540,954,1608],[360,402,540,954,1608],[360,402,540,954,1608],[360,402,540,954,1608]],
        "1x6.5cm": [[318,338,378,438,728],[318,338,378,472,799],[318,338,378,472,799],[318,338,378,472,799],[318,346,388,540,880],[318,346,388,540,880],[332,352,392,572,906],[332,360,402,606,978],[332,360,402,606,978],[332,360,416,637,1049],[332,374,430,728,1163],[332,374,430,728,1163],[332,374,430,728,1163],[346,374,430,756,1207],[346,374,430,756,1207],[346,374,430,756,1207],[346,374,430,756,1207],[346,376,434,745,1251],[346,376,434,745,1251],[346,376,434,799,1316],[346,376,434,799,1316],[346,388,438,853,1411],[346,388,472,880,1486],[360,402,540,954,1608],[360,402,540,954,1608],[360,402,540,954,1608],[360,402,540,954,1608]],
        "1x7cm": [[318,338,378,472,772],[318,346,386,540,880],[318,346,386,540,880],[318,346,386,540,880],[332,352,392,576,930],[332,352,392,576,930],[332,360,402,606,1001],[332,360,416,697,1095],[332,360,416,697,1095],[332,374,430,756,1207],[346,374,430,756,1185],[346,374,434,772,1273],[346,374,434,772,1273],[346,374,434,772,1273],[346,374,434,799,1362],[346,374,434,799,1362],[346,374,434,799,1362],[346,388,438,853,1411],[346,388,438,853,1411],[346,388,472,880,1486],[346,388,472,880,1486],[346,388,472,881,1586],[360,402,506,930,1685],[360,416,576,1073,1814],[360,416,576,1073,1814],[360,416,576,1073,1814],[360,416,576,1073,1814]],
        "1x7.5cm": [[318,338,378,472,772],[318,346,386,540,880],[318,346,386,540,880],[318,346,386,540,880],[332,352,392,576,930],[332,352,392,576,930],[332,360,402,606,1001],[332,360,416,697,1095],[332,360,416,697,1095],[332,374,430,756,1207],[346,374,430,756,1185],[346,374,434,772,1273],[346,374,434,772,1273],[346,374,434,772,1273],[346,374,434,799,1362],[346,374,434,799,1362],[346,374,434,799,1362],[346,388,438,853,1411],[346,388,438,853,1411],[346,388,472,880,1486],[346,388,472,880,1486],[346,388,472,881,1586],[360,402,506,930,1685],[360,416,576,1073,1814],[360,416,576,1073,1814],[360,416,576,1073,1814],[360,416,576,1073,1814]],
        "1x8cm": [[318,346,386,540,853],[318,346,388,576,930],[318,346,388,576,930],[318,346,388,576,930],[332,360,402,637,1025],[332,360,402,637,1025],[332,360,416,697,1095],[332,374,430,756,1207],[332,374,430,756,1207],[346,374,434,772,1273],[346,374,434,772,1294],[346,388,438,853,1411],[346,388,438,853,1411],[346,388,438,853,1411],[346,388,472,857,1511],[346,388,472,857,1511],[346,388,472,857,1511],[346,388,472,881,1561],[346,388,472,881,1561],[360,402,506,930,1659],[360,402,506,930,1659],[360,402,540,978,1678],[374,430,606,1119,1952],[374,430,606,1163,2042],[374,430,606,1163,2042],[374,430,606,1163,2042],[374,430,606,1163,2042]],
        "1x8.5cm": [[318,346,386,540,853],[318,346,388,576,930],[318,346,388,576,930],[318,346,388,576,930],[332,360,402,637,1025],[332,360,402,637,1025],[332,360,416,697,1095],[332,374,430,756,1207],[332,374,430,756,1207],[346,374,434,772,1273],[346,374,434,772,1294],[346,388,438,853,1411],[346,388,438,853,1411],[346,388,438,853,1411],[346,388,472,857,1511],[346,388,472,857,1511],[346,388,472,857,1511],[346,388,472,881,1561],[346,388,472,881,1561],[360,402,506,930,1659],[360,402,506,930,1659],[360,402,540,978,1678],[374,430,606,1119,1952],[374,430,606,1163,2042],[374,430,606,1163,2042],[374,430,606,1163,2042],[374,430,606,1163,2042]],
        "1x9cm": [[318,346,388,572,906],[332,352,402,606,1001],[332,352,402,606,1001],[332,352,402,606,1001],[332,360,416,697,1049],[332,360,416,697,1049],[332,360,430,756,1207],[346,374,434,799,1316],[346,374,434,799,1316],[346,374,438,826,1411],[346,388,472,857,1537],[360,402,506,954,1632],[360,402,506,954,1632],[360,402,506,954,1632],[360,402,540,1001,1723],[360,402,540,1001,1723],[360,402,540,1001,1723],[360,416,572,1025,1792],[360,416,572,1025,1792],[360,416,576,1095,1883],[360,416,576,1095,1883],[374,430,606,1163,2019],[374,430,637,1207,2131],[388,438,728,1362,2462],[388,438,728,1362,2462],[388,438,728,1362,2462],[388,438,728,1362,2462]],
        "1x9.5cm": [[318,346,388,572,906],[332,352,402,606,1001],[332,352,402,606,1001],[332,352,402,606,1001],[332,360,416,697,1049],[332,360,416,697,1049],[332,360,430,756,1207],[346,374,434,799,1316],[346,374,434,799,1316],[346,374,438,826,1411],[346,388,472,857,1537],[360,402,506,954,1632],[360,402,506,954,1632],[360,402,506,954,1632],[360,402,540,1001,1723],[360,402,540,1001,1723],[360,402,540,1001,1723],[360,416,572,1025,1792],[360,416,572,1025,1792],[360,416,576,1095,1883],[360,416,576,1095,1883],[374,430,606,1163,2019],[374,430,637,1207,2131],[388,438,728,1362,2462],[388,438,728,1362,2462],[388,438,728,1362,2462],[388,438,728,1362,2462]],
        "1x10cm": [[318,346,402,606,978],[332,360,416,667,1095],[332,360,416,667,1095],[332,360,416,667,1095],[332,360,430,756,1229],[332,360,430,756,1229],[332,374,434,772,1294],[346,388,438,853,1437],[346,388,438,853,1437],[346,388,472,857,1537],[346,388,472,881,1561],[360,402,506,954,1632],[360,402,506,954,1632],[360,402,506,954,1632],[360,402,540,1001,1723],[360,402,540,1001,1723],[360,402,540,1001,1723],[360,416,572,1025,1792],[360,416,572,1025,1792],[360,416,576,1095,1883],[360,416,576,1095,1883],[374,430,606,1163,2019],[374,430,637,1207,2131],[402,472,772,1537,2765],[402,472,772,1537,2765],[402,472,772,1537,2765],[402,472,772,1537,2765]],
        "1x10.5cm": [[318,346,402,606,978],[332,360,416,667,1095],[332,360,416,667,1095],[332,360,416,667,1095],[332,360,430,756,1229],[332,360,430,756,1229],[332,374,434,772,1294],[346,388,438,853,1437],[346,388,438,853,1437],[346,388,472,857,1537],[346,388,472,881,1561],[360,402,506,954,1632],[360,402,506,954,1632],[360,402,506,954,1632],[360,402,540,1001,1723],[360,402,540,1001,1723],[360,402,540,1001,1723],[360,416,572,1025,1792],[360,416,572,1025,1792],[360,416,576,1095,1883],[360,416,576,1095,1883],[374,430,606,1163,2019],[374,430,637,1207,2131],[402,472,772,1537,2765],[402,472,772,1537,2765],[402,472,772,1537,2765],[402,472,772,1537,2765]],
        "1x11cm": [[332,360,402,667,1095],[346,374,434,799,1362],[346,374,434,799,1362],[346,374,434,799,1362],[346,374,438,880,1511],[346,374,438,880,1511],[346,388,472,881,1635],[346,388,472,906,1635],[346,388,472,906,1635],[346,402,506,954,1632],[360,402,540,978,1701],[360,416,572,1049,1814],[360,416,572,1049,1814],[360,416,572,1049,1814],[374,430,637,1207,2154],[374,430,637,1207,2154],[374,430,637,1207,2154],[374,434,667,1251,2242],[374,434,667,1251,2242],[374,434,697,1316,2352],[374,434,697,1316,2352],[388,438,728,1411,2528],[388,438,697,1336,2397],[402,540,826,1608,3061],[402,540,826,1608,3061],[402,540,826,1608,3061],[402,540,826,1608,3061]],
        "1x11.5cm": [[332,360,402,667,1095],[346,374,434,799,1362],[346,374,434,799,1362],[346,374,434,799,1362],[346,374,438,880,1511],[346,374,438,880,1511],[346,388,472,881,1635],[346,388,472,906,1635],[346,388,472,906,1635],[346,402,506,954,1632],[360,402,540,978,1701],[360,416,572,1049,1814],[360,416,572,1049,1814],[360,416,572,1049,1814],[374,430,637,1207,2154],[374,430,637,1207,2154],[374,430,637,1207,2154],[374,434,667,1251,2242],[374,434,667,1251,2242],[374,434,697,1316,2352],[374,434,697,1316,2352],[388,438,728,1411,2528],[388,438,697,1336,2397],[402,540,826,1608,3061],[402,540,826,1608,3061],[402,540,826,1608,3061],[402,540,826,1608,3061]],
        "1x12cm": [[332,360,402,667,1095],[346,374,434,799,1362],[346,374,434,799,1362],[346,374,434,799,1362],[346,374,438,880,1511],[346,374,438,880,1511],[346,388,472,881,1635],[346,388,472,906,1635],[346,388,472,906,1635],[346,402,506,954,1632],[360,402,540,978,1701],[360,416,572,1049,1814],[360,416,572,1049,1814],[360,416,572,1049,1814],[374,430,637,1207,2154],[374,430,637,1207,2154],[374,430,637,1207,2154],[374,434,667,1251,2242],[374,434,667,1251,2242],[374,434,697,1316,2352],[374,434,697,1316,2352],[388,438,728,1411,2528],[388,438,697,1336,2397],[402,540,826,1608,3061],[402,540,826,1608,3061],[402,540,826,1608,3061],[402,540,826,1608,3061]],
        "1x12.5cm": [[332,360,416,728,1185],[332,374,434,772,1316],[332,374,434,772,1316],[332,374,434,772,1316],[346,388,438,880,1511],[346,388,438,880,1511],[346,388,472,881,1586],[360,402,540,978,1701],[360,402,540,978,1701],[360,402,572,1025,1814],[360,416,572,1049,1861],[374,430,606,1141,2019],[374,430,606,1141,2019],[374,430,606,1141,2019],[374,430,637,1207,2154],[374,430,637,1207,2154],[374,430,637,1207,2154],[374,434,728,1362,2440],[374,434,728,1362,2440],[388,438,756,1437,2592],[388,438,756,1437,2592],[388,438,728,1411,2571],[388,472,745,1486,2658],[416,572,857,1770,3352],[416,572,857,1770,3352],[416,572,857,1770,3352],[416,572,857,1770,3352]],
        "1x13cm": [[332,360,416,728,1185],[332,374,434,772,1316],[332,374,434,772,1316],[332,374,434,772,1316],[346,388,438,880,1511],[346,388,438,880,1511],[346,388,472,881,1586],[360,402,540,978,1701],[360,402,540,978,1701],[360,402,572,1025,1814],[360,416,572,1049,1861],[374,430,606,1141,2019],[374,430,606,1141,2019],[374,430,606,1141,2019],[374,430,637,1207,2154],[374,430,637,1207,2154],[374,430,637,1207,2154],[374,434,728,1362,2440],[374,434,728,1362,2440],[388,438,756,1437,2592],[388,438,756,1437,2592],[388,438,728,1411,2571],[388,472,745,1486,2658],[416,572,857,1770,3352],[416,572,857,1770,3352],[416,572,857,1770,3352],[416,572,857,1770,3352]],
        "1x13.5cm": [[332,360,416,728,1185],[332,374,434,772,1316],[332,374,434,772,1316],[332,374,434,772,1316],[346,388,438,880,1511],[346,388,438,880,1511],[346,388,472,881,1586],[360,402,540,978,1701],[360,402,540,978,1701],[360,402,572,1025,1814],[360,416,572,1049,1861],[374,430,606,1141,2019],[374,430,606,1141,2019],[374,430,606,1141,2019],[374,430,637,1207,2154],[374,430,637,1207,2154],[374,430,637,1207,2154],[374,434,728,1362,2440],[374,434,728,1362,2440],[388,438,756,1437,2592],[388,438,756,1437,2592],[388,438,728,1411,2571],[388,472,745,1486,2658],[416,572,857,1770,3352],[416,572,857,1770,3352],[416,572,857,1770,3352],[416,572,857,1770,3352]],
        "1x14cm": [[372,374,430,772,1294],[346,374,438,853,1462],[346,374,438,853,1462],[346,374,438,853,1462],[346,388,472,906,1659],[346,388,472,906,1659],[346,402,506,978,1678],[360,416,572,1073,1861],[360,416,572,1073,1861],[360,416,606,1141,2042],[374,430,637,1229,2198],[374,430,667,1251,2219],[374,430,667,1251,2219],[374,430,667,1251,2219],[374,434,697,1316,2352],[374,434,697,1316,2352],[374,434,697,1316,2352],[388,438,756,1486,2658],[388,438,756,1486,2658],[388,438,756,1437,2614],[388,438,756,1437,2614],[388,472,772,1537,2765],[402,506,799,1635,2914],[430,576,930,1928,3653],[430,576,930,1928,3653],[430,576,930,1928,3653],[430,576,930,1928,3653]],
        "1x14.5cm": [[372,374,430,772,1294],[346,374,438,853,1462],[346,374,438,853,1462],[346,374,438,853,1462],[346,388,472,906,1659],[346,388,472,906,1659],[346,402,506,978,1678],[360,416,572,1073,1861],[360,416,572,1073,1861],[360,416,606,1141,2042],[374,430,637,1229,2198],[374,430,667,1251,2219],[374,430,667,1251,2219],[374,430,667,1251,2219],[374,434,697,1316,2352],[374,434,697,1316,2352],[374,434,697,1316,2352],[388,438,756,1486,2658],[388,438,756,1486,2658],[388,438,756,1437,2614],[388,438,756,1437,2614],[388,472,772,1537,2765],[402,506,799,1635,2914],[430,576,930,1928,3653],[430,576,930,1928,3653],[430,576,930,1928,3653],[430,576,930,1928,3653]],
        "1x15cm": [[372,374,430,772,1294],[346,374,438,853,1462],[346,374,438,853,1462],[346,374,438,853,1462],[346,388,472,906,1659],[346,388,472,906,1659],[346,402,506,978,1678],[360,416,572,1073,1861],[360,416,572,1073,1861],[360,416,606,1141,2042],[374,430,637,1229,2198],[374,430,667,1251,2219],[374,430,667,1251,2219],[374,430,667,1251,2219],[374,434,697,1316,2352],[374,434,697,1316,2352],[374,434,697,1316,2352],[388,438,756,1486,2658],[388,438,756,1486,2658],[388,438,756,1437,2614],[388,438,756,1437,2614],[388,472,772,1537,2765],[402,506,799,1635,2914],[430,576,930,1928,3653],[430,576,930,1928,3653],[430,576,930,1928,3653],[430,576,930,1928,3653]],
        "1x15.5cm": [[332,374,434,826,1387],[346,388,472,881,1586],[346,388,472,881,1586],[346,388,472,881,1586],[346,402,540,978,1701],[346,402,540,978,1701],[360,402,572,1049,1838],[374,430,637,1229,2198],[374,430,637,1229,2198],[374,434,697,1336,2418],[388,438,756,1462,2635],[388,472,772,1610,2870],[388,472,772,1610,2870],[388,472,772,1610,2870],[388,472,745,1537,2765],[388,472,745,1537,2765],[388,472,745,1537,2765],[388,472,772,1586,2870],[388,472,772,1586,2870],[402,506,826,1685,3040],[402,506,826,1685,3040],[402,540,880,1701,3248],[402,540,853,1654,3165],[430,637,1001,2064,3962],[430,637,1001,2064,3962],[430,637,1001,2064,3962],[430,637,1001,2064,3962]],
        "1x16cm": [[332,374,434,826,1387],[346,388,472,881,1586],[346,388,472,881,1586],[346,388,472,881,1586],[346,402,540,978,1701],[346,402,540,978,1701],[360,402,572,1049,1838],[374,430,637,1229,2198],[374,430,637,1229,2198],[374,434,697,1336,2418],[388,438,756,1462,2635],[388,472,772,1610,2870],[388,472,772,1610,2870],[388,472,772,1610,2870],[388,472,745,1537,2765],[388,472,745,1537,2765],[388,472,745,1537,2765],[388,472,772,1586,2870],[388,472,772,1586,2870],[402,506,826,1685,3040],[402,506,826,1685,3040],[402,540,880,1701,3248],[402,540,853,1654,3165],[430,637,1001,2064,3962],[430,637,1001,2064,3962],[430,637,1001,2064,3962],[430,637,1001,2064,3962]],
        "1x16.5cm": [[332,374,434,826,1387],[346,388,472,881,1586],[346,388,472,881,1586],[346,388,472,881,1586],[346,402,540,978,1701],[346,402,540,978,1701],[360,402,572,1049,1838],[374,430,637,1229,2198],[374,430,637,1229,2198],[374,434,697,1336,2418],[388,438,756,1462,2635],[388,472,772,1610,2870],[388,472,772,1610,2870],[388,472,772,1610,2870],[388,472,745,1537,2765],[388,472,745,1537,2765],[388,472,745,1537,2765],[388,472,772,1586,2870],[388,472,772,1586,2870],[402,506,826,1685,3040],[402,506,826,1685,3040],[402,540,880,1701,3248],[402,540,853,1654,3165],[430,637,1001,2064,3962],[430,637,1001,2064,3962],[430,637,1001,2064,3962],[430,637,1001,2064,3962]],
        "1x17cm": [[346,374,438,880,1511],[346,388,506,976,1608],[346,388,506,976,1608],[346,388,506,976,1608],[360,402,572,1049,1838],[360,402,572,1049,1838],[360,416,576,1119,1974],[374,430,637,1229,2198],[374,430,637,1229,2198],[374,434,667,1294,2331],[388,438,756,1462,2635],[388,472,772,1610,2870],[388,472,772,1610,2870],[388,472,772,1610,2870],[402,506,826,1608,3040],[402,506,826,1608,3040],[402,506,826,1608,3040],[402,540,853,1654,3144],[402,540,853,1654,3144],[416,572,857,1770,3331],[416,572,857,1770,3331],[416,576,906,1883,3565],[416,572,881,1792,3413],[434,697,1073,2309,4378],[434,697,1073,2309,4378],[434,697,1073,2309,4378],[434,697,1073,2309,4378]],
        "1x17.5cm": [[346,374,438,880,1511],[346,388,506,976,1608],[346,388,506,976,1608],[346,388,506,976,1608],[360,402,572,1049,1838],[360,402,572,1049,1838],[360,416,576,1119,1974],[374,430,637,1229,2198],[374,430,637,1229,2198],[374,434,667,1294,2331],[388,438,756,1462,2635],[388,472,772,1610,2870],[388,472,772,1610,2870],[388,472,772,1610,2870],[402,506,826,1608,3040],[402,506,826,1608,3040],[402,506,826,1608,3040],[402,540,853,1654,3144],[402,540,853,1654,3144],[416,572,857,1770,3331],[416,572,857,1770,3331],[416,576,906,1883,3565],[416,572,881,1792,3413],[434,697,1073,2309,4378],[434,697,1073,2309,4378],[434,697,1073,2309,4378],[434,697,1073,2309,4378]],
        "1x18cm": [[346,374,438,880,1511],[346,388,506,976,1608],[346,388,506,976,1608],[346,388,506,976,1608],[360,402,572,1049,1838],[360,402,572,1049,1838],[360,416,576,1119,1974],[374,430,637,1229,2198],[374,430,637,1229,2198],[374,434,667,1294,2331],[388,438,756,1462,2635],[388,472,772,1610,2870],[388,472,772,1610,2870],[388,472,772,1610,2870],[402,506,826,1608,3040],[402,506,826,1608,3040],[402,506,826,1608,3040],[402,540,853,1654,3144],[402,540,853,1654,3144],[416,572,857,1770,3331],[416,572,857,1770,3331],[416,576,906,1883,3565],[416,572,881,1792,3413],[434,697,1073,2309,4378],[434,697,1073,2309,4378],[434,697,1073,2309,4378],[434,697,1073,2309,4378]],
        "1x18.5cm": [[346,388,472,906,1659],[346,402,540,1025,1770],[346,402,540,1025,1770],[346,402,540,1025,1770],[360,416,576,1163,2042],[360,416,576,1163,2042],[360,430,637,1229,2176],[374,434,697,1336,2418],[374,434,697,1336,2418],[374,438,728,1437,2571],[402,506,826,1608,3040],[402,540,853,1654,3144],[402,540,853,1654,3144],[402,540,853,1654,3144],[402,506,826,1608,3040],[402,506,826,1608,3040],[402,506,826,1608,3040],[402,540,853,1654,3144],[402,540,853,1654,3144],[416,572,857,1770,3331],[416,572,857,1770,3331],[416,576,906,1883,3565],[430,606,954,1997,3763],[434,697,1073,2309,4378],[434,697,1073,2309,4378],[434,697,1073,2309,4378],[434,697,1073,2309,4378]],
        "1x19cm": [[346,388,472,906,1659],[346,402,540,1025,1770],[346,402,540,1025,1770],[346,402,540,1025,1770],[360,416,576,1163,2042],[360,416,576,1163,2042],[360,430,637,1229,2176],[374,434,697,1336,2418],[374,434,697,1336,2418],[374,438,728,1437,2571],[402,506,826,1608,3040],[402,540,853,1654,3144],[402,540,853,1654,3144],[402,540,853,1654,3144],[402,506,826,1608,3040],[402,506,826,1608,3040],[402,506,826,1608,3040],[402,540,853,1654,3144],[402,540,853,1654,3144],[416,572,857,1770,3331],[416,572,857,1770,3331],[416,576,906,1883,3565],[430,606,954,1997,3763],[434,697,1073,2309,4378],[434,697,1073,2309,4378],[434,697,1073,2309,4378],[434,697,1073,2309,4378]],
        "1x19.5cm": [[346,388,472,906,1659],[346,402,540,1025,1770],[346,402,540,1025,1770],[346,402,540,1025,1770],[360,416,576,1163,2042],[360,416,576,1163,2042],[360,430,637,1229,2176],[374,434,697,1336,2418],[374,434,697,1336,2418],[374,438,728,1437,2571],[402,506,826,1608,3040],[402,540,853,1654,3144],[402,540,853,1654,3144],[402,540,853,1654,3144],[402,506,826,1608,3040],[402,506,826,1608,3040],[402,506,826,1608,3040],[402,540,853,1654,3144],[402,540,853,1654,3144],[416,572,857,1770,3331],[416,572,857,1770,3331],[416,576,906,1883,3565],[430,606,954,1997,3763],[434,697,1073,2309,4378],[434,697,1073,2309,4378],[434,697,1073,2309,4378],[434,697,1073,2309,4378]],
        "1x20cm": [[346,388,472,906,1659],[346,402,540,1025,1770],[346,402,540,1025,1770],[346,402,540,1025,1770],[360,416,576,1163,2042],[360,416,576,1163,2042],[360,430,637,1229,2176],[374,434,697,1336,2418],[374,434,697,1336,2418],[374,438,728,1437,2571],[402,506,826,1608,3040],[402,540,853,1654,3144],[402,540,853,1654,3144],[402,540,853,1654,3144],[402,506,826,1608,3040],[402,506,826,1608,3040],[402,506,826,1608,3040],[402,540,853,1654,3144],[402,540,853,1654,3144],[416,572,857,1770,3331],[416,572,857,1770,3331],[416,576,906,1883,3565],[430,606,954,1997,3763],[434,697,1073,2309,4378],[434,697,1073,2309,4378],[434,697,1073,2309,4378],[434,697,1073,2309,4378]]
      };

      // ç‹€æ…‹ç®¡ç†
      const state = {
        elements: {},
        filteredMaterials: [...CONFIG.materials],
        highlightedIndex: -1,
        isAnimating: false,
        searchTimeout: null,
        currentHighlightedRow: null
      };

      // å·¥å…·å‡½æ•¸
      const utils = {
        debounce(func, wait) {
          return function executedFunction(...args) {
            const later = () => {
              clearTimeout(state.searchTimeout);
              func(...args);
            };
            clearTimeout(state.searchTimeout);
            state.searchTimeout = setTimeout(later, wait);
          };
        }
      };

      // æ”¶åˆåŠŸèƒ½
      function toggleCollapse(contentId) {
        const content = document.getElementById(contentId);
        const btnId = contentId === 'size-buttons-content' ? 'size-collapse-btn' : 'select-collapse-btn';
        const btn = document.getElementById(btnId);
        
        if (!content || !btn) return;
        
        try {
          if (content.classList.contains('collapsed')) {
            content.classList.remove('collapsed');
            content.style.maxHeight = content.scrollHeight + 'px';
            btn.textContent = 'âˆ’';
            btn.setAttribute('aria-expanded', 'true');
            
            // å±•é–‹å¾Œç«‹å³å’Œå»¶é²é‡æ–°è¨ˆç®—è¡¨æ ¼é«˜åº¦
            requestAnimationFrame(() => {
              adjustTableHeight();
              setTimeout(adjustTableHeight, 350);
            });
          } else {
            content.style.maxHeight = content.scrollHeight + 'px';
            content.offsetHeight;
            setTimeout(() => {
              content.classList.add('collapsed');
              content.style.maxHeight = '0';
              btn.textContent = '+';
              btn.setAttribute('aria-expanded', 'false');
              
              // æ”¶åˆå¾Œç«‹å³å’Œå»¶é²é‡æ–°è¨ˆç®—è¡¨æ ¼é«˜åº¦
              requestAnimationFrame(() => {
                adjustTableHeight();
                setTimeout(adjustTableHeight, 350);
              });
            }, 10);
          }
        } catch (error) {
          console.warn('Toggle collapse error:', error);
        }
      }

      // æè³ªä¸‹æ‹‰é¸å–®ç›¸é—œå‡½æ•¸
      const materialDropdown = {
        render() {
          if (!state.elements.materialDropdown) return;
          
          state.elements.materialDropdown.innerHTML = '';
          
          if (state.filteredMaterials.length === 0) {
            const noResults = document.createElement('div');
            noResults.className = 'no-results';
            noResults.textContent = 'æ‰¾ä¸åˆ°ç¬¦åˆçš„æè³ª';
            state.elements.materialDropdown.appendChild(noResults);
            return;
          }
          
          state.filteredMaterials.forEach((material, index) => {
            const option = document.createElement('div');
            option.className = 'material-option';
            option.textContent = material;
            option.setAttribute('role', 'option');
            option.setAttribute('aria-selected', index === state.highlightedIndex ? 'true' : 'false');
            option.addEventListener('click', () => this.select(material));
            option.addEventListener('mouseenter', () => {
              state.highlightedIndex = index;
              this.updateHighlight();
            });
            
            if (index === state.highlightedIndex) {
              option.classList.add('highlighted');
            }
            
            state.elements.materialDropdown.appendChild(option);
          });
        },

        updateHighlight() {
          const options = state.elements.materialDropdown.querySelectorAll('.material-option');
          options.forEach((option, index) => {
            const isHighlighted = index === state.highlightedIndex;
            option.classList.toggle('highlighted', isHighlighted);
            option.setAttribute('aria-selected', isHighlighted ? 'true' : 'false');
          });
        },

        show() {
          if (!state.elements.materialDropdown || !state.elements.materialDropdownBtn || !state.elements.materialInput) return;
          
          state.elements.materialDropdown.classList.add('show');
          state.elements.materialDropdownBtn.classList.add('open');
          state.elements.materialInput.setAttribute('aria-expanded', 'true');
          
          if (state.filteredMaterials.length > 0 && state.highlightedIndex < 0) {
            state.highlightedIndex = 0;
            this.updateHighlight();
          }
        },

        hide() {
          if (!state.elements.materialDropdown || !state.elements.materialDropdownBtn || !state.elements.materialInput) return;
          
          state.elements.materialDropdown.classList.remove('show');
          state.elements.materialDropdownBtn.classList.remove('open');
          state.elements.materialInput.setAttribute('aria-expanded', 'false');
          state.highlightedIndex = -1;
        },

        toggle() {
          if (state.elements.materialDropdown.classList.contains('show')) {
            this.hide();
          } else {
            state.filteredMaterials = [...CONFIG.materials];
            state.highlightedIndex = 0;
            this.render();
            this.show();
            state.elements.materialInput.focus();
          }
        },

        select(material) {
          if (!material || !CONFIG.materials.includes(material) || state.isAnimating) return;
          
          state.elements.materialInput.value = material;
          this.hide();
          state.isAnimating = true;
          
          const materialIndex = CONFIG.materials.indexOf(material);
          if (materialIndex === -1) {
            state.isAnimating = false;
            return;
          }

          setTimeout(() => {
            const table = document.querySelector('#table-container table');
            if (!table) {
              state.isAnimating = false;
              return;
            }
            
            const materialRows = table.querySelectorAll('tr');
            const targetRow = materialRows[materialIndex + 1];
            
            if (targetRow) {
              clearHighlight();
              targetRow.scrollIntoView({ 
                behavior: 'smooth', 
                block: 'center' 
              });
              
              setTimeout(() => {
                targetRow.classList.add('material-highlight');
                state.currentHighlightedRow = targetRow;
                
                setTimeout(() => {
                  if (targetRow === state.currentHighlightedRow) {
                    targetRow.classList.remove('material-highlight');
                    state.currentHighlightedRow = null;
                  }
                  state.isAnimating = false;
                }, 1000);
              }, 500);
            } else {
              state.isAnimating = false;
            }
          }, 200);
        }
      };

      // å‹•æ…‹èª¿æ•´è¡¨æ ¼é«˜åº¦
      function adjustTableHeight() {
        const tableScrollContainer = document.querySelector('.table-scroll-container');
        if (!tableScrollContainer) return;

        const windowHeight = window.innerHeight;
        const tableWrapper = document.querySelector('.table-wrapper');
        if (!tableWrapper) return;

        // ç²å–è¡¨æ ¼å®¹å™¨çš„ä½ç½®
        const tableWrapperRect = tableWrapper.getBoundingClientRect();
        const dragAreaHeight = window.innerWidth <= 768 ? 35 : 40;
        const scrollHintHeight = 30;
        
        // æª¢æŸ¥æ˜¯å¦ç‚ºç§»å‹•è£ç½®
        const isMobile = window.innerWidth <= 768;
        const isSmallMobile = window.innerWidth <= 480;
        
        // è¨ˆç®—è¡¨æ ¼ä¸Šæ–¹çš„å¯¦éš›é«˜åº¦
        const tableTop = Math.max(0, tableWrapperRect.top);
        
        // åº•éƒ¨ä¿ç•™ç©ºé–“ï¼ˆç§»å‹•è£ç½®è¼ƒå°‘ï¼‰
        const bottomMargin = isMobile ? 10 : 20;
        
        // è¨ˆç®—å¯ç”¨é«˜åº¦
        let availableHeight = windowHeight - tableTop - dragAreaHeight - scrollHintHeight - bottomMargin;
        
        // å¦‚æœè¡¨æ ¼å·²ç¶“åœ¨è¦–çª—é ‚éƒ¨æˆ–æ¥è¿‘é ‚éƒ¨ï¼Œçµ¦äºˆæ›´å¤šé«˜åº¦
        if (tableTop < 100) {
          availableHeight = windowHeight - dragAreaHeight - scrollHintHeight - bottomMargin - Math.max(0, tableTop);
          tableWrapper.classList.add('near-top');
        } else {
          tableWrapper.classList.remove('near-top');
        }
        
        // è¨­å®šæœ€å°å’Œæœ€å¤§é«˜åº¦é™åˆ¶
        let minHeight = isSmallMobile ? 250 : (isMobile ? 300 : 400);
        let maxHeight = isSmallMobile ? windowHeight * 0.9 : (isMobile ? windowHeight * 0.85 : windowHeight * 0.8);
        
        // ç¢ºä¿é«˜åº¦åœ¨åˆç†ç¯„åœå…§
        availableHeight = Math.max(minHeight, Math.min(availableHeight, maxHeight));
        
        // è¨­ç½®é«˜åº¦
        tableScrollContainer.style.height = availableHeight + 'px';
      }

      // ç›£æ¸¬è¡¨æ ¼æ˜¯å¦åœ¨è¦–çª—ä¸­ä¸¦èª¿æ•´é«˜åº¦
      function setupIntersectionObserver() {
        const tableWrapper = document.querySelector('.table-wrapper');
        if (!tableWrapper) return;

        const observerOptions = {
          root: null,
          rootMargin: '-50px 0px -50px 0px',
          threshold: [0, 0.1, 0.5, 0.9, 1]
        };

        const observer = new IntersectionObserver((entries) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              // ç•¶è¡¨æ ¼é€²å…¥è¦–çª—æ™‚èª¿æ•´é«˜åº¦
              adjustTableHeight();
            }
          });
        }, observerOptions);

        observer.observe(tableWrapper);
        
        // å„²å­˜ observer ä»¥ä¾¿æ¸…ç†
        window.tableIntersectionObserver = observer;
      }

      // å„ªåŒ–çš„æ»¾å‹•ç›£è½
      function setupScrollListener() {
        let ticking = false;
        let lastScrollY = window.scrollY;
        
        function handleScroll() {
          const currentScrollY = window.scrollY;
          const scrollDiff = Math.abs(currentScrollY - lastScrollY);
          
          // åªæœ‰åœ¨æ»¾å‹•è·é›¢è¶…éé–¾å€¼æ™‚æ‰æ›´æ–°ï¼ˆå„ªåŒ–æ€§èƒ½ï¼‰
          if (scrollDiff > 5 && !ticking) {
            window.requestAnimationFrame(() => {
              adjustTableHeight();
              lastScrollY = currentScrollY;
              ticking = false;
            });
            ticking = true;
          }
        }
        
        // ä½¿ç”¨ç¯€æµçš„æ»¾å‹•ç›£è½
        window.addEventListener('scroll', handleScroll, { passive: true });
        
        // è§¸æ§è£ç½®çš„ç‰¹æ®Šè™•ç†
        if ('ontouchstart' in window) {
          window.addEventListener('touchmove', handleScroll, { passive: true });
        }
        
        window.scrollHandler = handleScroll;
      }

      // é˜²æŠ–å‡½æ•¸ç”¨æ–¼ resize äº‹ä»¶
      function debounceResize(func, wait) {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func(...args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      }

      // è¡¨æ ¼ç”Ÿæˆ
      function generateTable(size) {
        if (!size) return;
        
        state.elements.tableContainer.classList.add('table-loading');
        
        const data = priceData[size];
        if (!data) {
          state.elements.tableContainer.innerHTML = '<p style="color:red !important; text-align: center !important; padding: 20px !important;">æ­¤å°ºå¯¸å°šç„¡åƒ¹ç›®è¡¨è³‡æ–™</p>';
          state.elements.tableContainer.classList.remove('table-loading');
          return;
        }

        let html = '<table role="table" aria-label="åƒ¹ç›®è¡¨">';
        
        // æ¨™é¡Œè¡Œ
        html += '<tr role="row">';
        html += '<th class="material-name empty-corner" scope="col"></th>';
        CONFIG.quantities.forEach(q => html += `<th class="qty-header" scope="col">${q}</th>`);
        html += '</tr>';

        // æè³ªåƒ¹æ ¼è¡Œ
        CONFIG.materials.forEach((mat, i) => {
          if (!data[i]) return;
          const even = i % 2 === 0;
          const materialBg = even ? 'material-even' : 'material-odd';
          const priceBg = even ? 'price-even' : 'price-odd';
          
          html += `<tr role="row"><th class="material-name ${materialBg}" scope="row">${mat}</th>`;
          data[i].forEach(p => {
            const formattedPrice = Math.round(p).toLocaleString();
            html += `<td class="${priceBg}">${formattedPrice}</td>`;
          });
          html += '</tr>';
        });

        state.elements.tableContainer.innerHTML = html + '</table>';
        
        setTimeout(() => {
          state.elements.tableContainer.classList.remove('table-loading');
          adjustTableHeight(); // è¡¨æ ¼ç”Ÿæˆå¾Œèª¿æ•´é«˜åº¦
        }, 100);
      }

      // æ¸…é™¤é«˜äº®
      function clearHighlight() {
        if (state.currentHighlightedRow) {
          state.currentHighlightedRow.classList.remove('material-highlight');
          state.currentHighlightedRow = null;
        }
        document.querySelectorAll('.material-highlight').forEach(row => {
          row.classList.remove('material-highlight');
        });
      }

      // å°ºå¯¸é¸æ“‡
      function selectSize(size) {
        if (!size || !CONFIG.sizes.includes(size)) return;
        
        state.elements.select.value = size;
        state.elements.tableHeader.textContent = size;
        
        document.querySelectorAll('.size-btn').forEach(btn => 
          btn.classList.toggle('active', btn.textContent === size)
        );

        if (state.elements.materialInput) {
          state.elements.materialInput.value = '';
          state.elements.materialInput.setAttribute('aria-expanded', 'false');
        }
        state.filteredMaterials = [...CONFIG.materials];
        materialDropdown.hide();
        clearHighlight();
        generateTable(size);
        
        // å°ºå¯¸æ”¹è®Šå¾Œå¯èƒ½éœ€è¦é‡æ–°èª¿æ•´é«˜åº¦
        setTimeout(adjustTableHeight, 150);
      }

      function selectSizeFromButton(size) {
        selectSize(size);
        const selectAreaSection = document.querySelector('.select-area');
        if (selectAreaSection) {
          setTimeout(() => {
            selectAreaSection.scrollIntoView({ 
              behavior: 'smooth', 
              block: 'start' 
            });
            // æ»¾å‹•å®Œæˆå¾Œé‡æ–°è¨ˆç®—è¡¨æ ¼é«˜åº¦
            setTimeout(adjustTableHeight, 500);
          }, 100);
        }
      }

      // å›åˆ°é ‚éƒ¨åŠŸèƒ½
      function initBackToTop() {
        const backToTopBtn = document.getElementById('back-to-top');
        if (!backToTopBtn) return;

        let isScrolling = false;
        
        function handleScroll() {
          if (!isScrolling) {
            requestAnimationFrame(() => {
              const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
              if (scrollTop > 300) {
                backToTopBtn.classList.add('show');
              } else {
                backToTopBtn.classList.remove('show');
              }
              isScrolling = false;
            });
            isScrolling = true;
          }
        }

        function scrollToTop() {
          const scrollToTopSmooth = () => {
            const scrollTop = window.pageYOffset || document.documentElement.scrollTop;
            if (scrollTop > 0) {
              window.scrollTo(0, scrollTop * 0.85);
              requestAnimationFrame(scrollToTopSmooth);
            }
          };
          
          if (window.CSS && CSS.supports('scroll-behavior', 'smooth')) {
            window.scrollTo({ top: 0, behavior: 'smooth' });
          } else {
            scrollToTopSmooth();
          }
        }

        window.addEventListener('scroll', handleScroll, { passive: true });
        backToTopBtn.addEventListener('click', scrollToTop);
        handleScroll();
      }

      // äº‹ä»¶è™•ç†
      const eventHandlers = {
        handleMaterialInput: utils.debounce((e) => {
          const query = e.target.value.toLowerCase().trim();
          state.filteredMaterials = CONFIG.materials.filter(material => 
            material.toLowerCase().includes(query)
          );
          state.highlightedIndex = state.filteredMaterials.length > 0 ? 0 : -1;
          materialDropdown.render();
          materialDropdown.show();
        }, 200),

        handleKeydown(e) {
          if (!state.elements.materialDropdown.classList.contains('show')) {
            if (e.key === 'ArrowDown' || e.key === 'Enter') {
              e.preventDefault();
              materialDropdown.show();
            }
            return;
          }

          const maxIndex = Math.max(0, state.filteredMaterials.length - 1);

          switch (e.key) {
            case 'ArrowDown':
              e.preventDefault();
              state.highlightedIndex = state.highlightedIndex < maxIndex ? state.highlightedIndex + 1 : 0;
              materialDropdown.updateHighlight();
              break;
            case 'ArrowUp':
              e.preventDefault();
              state.highlightedIndex = state.highlightedIndex > 0 ? state.highlightedIndex - 1 : maxIndex;
              materialDropdown.updateHighlight();
              break;
            case 'Enter':
              e.preventDefault();
              if (state.highlightedIndex >= 0 && state.filteredMaterials[state.highlightedIndex]) {
                materialDropdown.select(state.filteredMaterials[state.highlightedIndex]);
              }
              break;
            case 'Escape':
              e.preventDefault();
              materialDropdown.hide();
              state.elements.materialInput.blur();
              break;
            case 'Tab':
              materialDropdown.hide();
              break;
          }
        },

        handleInputBlur(e) {
          setTimeout(() => {
            if (!e.relatedTarget || !e.relatedTarget.closest('.material-search-container')) {
              materialDropdown.hide();
            }
          }, 150);
        },

        handleOutsideClick(e) {
          if (!e.target.closest('.material-search-container')) {
            materialDropdown.hide();
          }
        }
      };

      // åˆå§‹åŒ–
      function init() {
        // ç²å–DOMå…ƒç´ 
        Object.assign(state.elements, {
          select: document.getElementById('size-select'),
          materialInput: document.getElementById('material-input'),
          materialDropdownBtn: document.getElementById('material-dropdown-btn'),
          materialDropdown: document.getElementById('material-dropdown'),
          buttonsContainer: document.getElementById('buttons'),
          tableContainer: document.getElementById('table-container'),
          tableHeader: document.getElementById('table-header')
        });

        // é©—è­‰å¿…è¦å…ƒç´ 
        const requiredElements = ['select', 'materialInput', 'buttonsContainer', 'tableContainer'];
        for (const elem of requiredElements) {
          if (!state.elements[elem]) {
            throw new Error(`Required element not found: ${elem}`);
          }
        }

        // ç”Ÿæˆå°ºå¯¸é¸é …å’ŒæŒ‰éˆ•
        CONFIG.sizes.forEach(size => {
          // ä¸‹æ‹‰é¸å–®é¸é …
          const option = document.createElement('option');
          option.value = option.textContent = size;
          state.elements.select.appendChild(option);
          
          // æŒ‰éˆ•
          const btn = document.createElement('button');
          btn.className = 'size-btn';
          btn.textContent = size;
          btn.onclick = () => selectSizeFromButton(size);
          btn.setAttribute('aria-label', `é¸æ“‡å°ºå¯¸ ${size}`);
          state.elements.buttonsContainer.appendChild(btn);
        });

        // åˆå§‹åŒ–æè³ªä¸‹æ‹‰é¸é …
        materialDropdown.render();
        
        // è¨­ç½®ç„¡éšœç¤™å±¬æ€§
        state.elements.materialInput.setAttribute('role', 'combobox');
        state.elements.materialInput.setAttribute('aria-expanded', 'false');
        state.elements.materialInput.setAttribute('aria-haspopup', 'listbox');
        state.elements.materialDropdown.setAttribute('role', 'listbox');
        
        // äº‹ä»¶ç›£è½
        state.elements.select.onchange = () => selectSize(state.elements.select.value);
        state.elements.materialInput.addEventListener('input', eventHandlers.handleMaterialInput);
        state.elements.materialInput.addEventListener('focus', () => materialDropdown.show());
        state.elements.materialInput.addEventListener('keydown', eventHandlers.handleKeydown);
        state.elements.materialInput.addEventListener('blur', eventHandlers.handleInputBlur);
        
        if (state.elements.materialDropdownBtn) {
          state.elements.materialDropdownBtn.addEventListener('click', (e) => {
            e.preventDefault();
            e.stopPropagation();
            materialDropdown.toggle();
          });
        }
        
        document.addEventListener('click', eventHandlers.handleOutsideClick);
        
        // é˜²æ­¢è¡¨å–®æäº¤
        const form = document.querySelector('form');
        if (form) {
          form.addEventListener('submit', (e) => e.preventDefault());
        }
        
        // è¨­ç½®åˆå§‹é«˜åº¦
        ['size-buttons-content', 'select-area-content'].forEach(id => {
          const content = document.getElementById(id);
          if (content) {
            content.style.maxHeight = content.scrollHeight + 'px';
            content.classList.remove('collapsed');
            
            const btnId = id === 'size-buttons-content' ? 'size-collapse-btn' : 'select-collapse-btn';
            const btn = document.getElementById(btnId);
            if (btn) {
              btn.textContent = 'âˆ’';
              btn.setAttribute('aria-expanded', 'true');
            }
          }
        });
        
        // åˆå§‹åŒ–å›åˆ°é ‚éƒ¨åŠŸèƒ½
        initBackToTop();
        
        // æ·»åŠ è¦–çª—å¤§å°æ”¹è®Šäº‹ä»¶ç›£è½
        window.debouncedAdjustHeight = debounceResize(adjustTableHeight, 250);
        window.addEventListener('resize', window.debouncedAdjustHeight);
        
        // è¨­ç½® Intersection Observer
        setupIntersectionObserver();
        
        // è¨­ç½®æ»¾å‹•ç›£è½
        setupScrollListener();
        
        // åˆå§‹é¸æ“‡
        selectSize(CONFIG.sizes[0]);
        
        // åˆå§‹èª¿æ•´é«˜åº¦ï¼ˆå»¶é²åŸ·è¡Œä»¥ç¢ºä¿ DOM å®Œå…¨è¼‰å…¥ï¼‰
        setTimeout(() => {
          adjustTableHeight();
          // å†æ¬¡èª¿æ•´ä»¥ç¢ºä¿æº–ç¢º
          setTimeout(adjustTableHeight, 300);
        }, 100);
      }

      // æ¸…ç†å‡½æ•¸
      function cleanup() {
        clearTimeout(state.searchTimeout);
        clearHighlight();
        state.isAnimating = false;
        
        // ç§»é™¤äº‹ä»¶ç›£è½å™¨
        if (window.debouncedAdjustHeight) {
          window.removeEventListener('resize', window.debouncedAdjustHeight);
        }
        if (window.scrollHandler) {
          window.removeEventListener('scroll', window.scrollHandler);
          window.removeEventListener('touchmove', window.scrollHandler);
        }
        
        // æ–·é–‹ Intersection Observer
        if (window.tableIntersectionObserver) {
          window.tableIntersectionObserver.disconnect();
        }
      }

      // å…¬é–‹API
      return {
        init,
        cleanup,
        toggleCollapse,
        materialDropdown
      };
    })();

    // å•Ÿå‹•ç³»çµ±
    window.toggleCollapse = PriceTableSystem.toggleCollapse;
    window.addEventListener('beforeunload', PriceTableSystem.cleanup);
    document.addEventListener('DOMContentLoaded', PriceTableSystem.init);
  </script>

</body>
</html>
